<app-header [title]="'Resumen'" [icon]="'fas fa-tachometer-alt'"></app-header>

<div class="p-4 space-y-6 max-w-4xl mx-auto">
  <label class="flex items-center space-x-2">
    <span class="font-medium">AÃ±o:</span>
    <input
      type="number"
      [(ngModel)]="year"
      (change)="cargarResumen()"
      class="border rounded px-3 py-1 w-24"
    />
  </label>

  <div *ngIf="loading" class="text-center text-gray-600 text-lg">
    <i class="pi pi-spin pi-spinner text-2xl text-primary"></i>
    <p class="mt-2">Cargando resumen...</p>
  </div>

  <div *ngIf="!loading && resumen" class="space-y-6">
    <div class="bg-white shadow rounded-xl p-6">
      <h2 class="text-xl font-semibold mb-4">Resumen de facturas {{ year }}</h2>
      <ul class="space-y-2 text-gray-700">
        <li><strong>Total facturas:</strong> {{ resumen.totalFacturas }}</li>
        <li><strong>Pagadas:</strong> {{ resumen.pagadas }}</li>
        <li><strong>No pagadas:</strong> {{ resumen.noPagadas }}</li>
        <li>
          <strong>Importe total:</strong> {{ resumen.totalImporte | currency }}
        </li>
        <li>
          <strong>Importe pagadas:</strong>
          {{ resumen.importePagadas | currency }}
        </li>
        <li>
          <strong>Importe no pagadas:</strong>
          {{ resumen.importeNoPagadas | currency }}
        </li>
        <li>
          <strong>Promedio por factura:</strong>
          {{ resumen.promedioImporte | currency }}
        </li>
        <li>
          <strong>Promedio pagadas:</strong>
          {{ resumen.promedioPagadas | currency }}
        </li>
        <li>
          <strong>Promedio no pagadas:</strong>
          {{ resumen.promedioNoPagadas | currency }}
        </li>
      </ul>
    </div>

    <div class="bg-white shadow rounded-xl p-6">
      <h3 class="text-lg font-semibold mb-4">Resumen mensual</h3>
      <div class="overflow-x-auto">
        <table
          class="min-w-full border rounded overflow-hidden text-sm text-gray-700"
        >
          <thead class="bg-gray-100 text-left">
            <tr>
              <th class="py-2 px-4">Mes</th>
              <th class="py-2 px-4">Total</th>
              <th class="py-2 px-4">Pagadas</th>
              <th class="py-2 px-4">No Pagadas</th>
              <th class="py-2 px-4">Importe Total</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let mes of mensual" class="hover:bg-gray-50 border-t">
              <td class="py-2 px-4">{{ mes.mes }}</td>
              <td class="py-2 px-4">{{ mes.total }}</td>
              <td class="py-2 px-4">{{ mes.pagadas }}</td>
              <td class="py-2 px-4">{{ mes.noPagadas }}</td>
              <td class="py-2 px-4">{{ mes.totalImporte | currency }}</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>
