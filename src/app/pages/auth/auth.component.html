<div class="flex justify-center items-center md:h-screen">
  <!-- <div class="absolute md:top-8 px-6 top-3 z-10">
    <span
      class="flex items-center gap-1 px-3 py-1 bg-blue-100 text-blue-800 text-sm font-semibold rounded-full shadow-sm"
    >
      <i class="pi pi-info-circle mr-2"></i>
      <p>
        El inicio de sesión puede tardar unos segundos en completarse.
        Agradecemos su paciencia.
      </p>
    </span>
  </div> -->

  <div
    class="flex flex-col md:flex-row w-full max-w-5xl p-6 bg-white shadow-xl rounded-lg"
  >
    <div class="flex-1 p-5 flex flex-col items-center">
      <img
        src="/assets/ico/FaktuFlow.avif"
        class="md:w-80 w-72 mb-12 md:mt-8 mt-20"
        width="176"
        height="128"
        alt="Logo FaktuFlow"
      />

      <h2 class="mb-4 h2-form">Acceso usuarios</h2>

      <form class="max-w-[332px]">
        <div class="mb-5">
          <label for="email">Email</label>
          <p-inputGroup>
            <p-inputGroupAddon>
              <i class="pi pi-envelope"></i>
            </p-inputGroupAddon>
            <input
              pInputText
              placeholder="Introduce tu email..."
              [(ngModel)]="email"
              name="email"
              autocomplete="email"
              required
            />
          </p-inputGroup>
        </div>

        <label for="password">Contraseña</label>

        <div class="mb-5 password-style">
          <div class="flex">
            <div class="flex">
              <p-inputGroupAddon>
                <i class="pi pi-lock"></i>
              </p-inputGroupAddon>

              <p-password
                [toggleMask]="true"
                [feedback]="false"
                [(ngModel)]="password"
                styleClass="w-72"
                placeholder="Introduce tu contraseña..."
                name="password"
                autocomplete="current-password"
                required
              ></p-password>
            </div>
          </div>
        </div>

        <div class="flex justify-center">
          <div class="g-recaptcha" [attr.data-sitekey]="recaptchaSiteKey"></div>
        </div>

        <div class="mt-4" *ngFor="let message of messagesLogin">
          <p-message
            [life]="8000"
            icon="pi pi-times-circle"
            [severity]="message.severity"
            [text]="message.text"
            [closable]="true"
            styleClass="custom-messages"
          ></p-message>
        </div>

        <div class="pt-11 -mb-6" *ngIf="loading">
          <app-loading></app-loading>
        </div>

        <div class="w-full flex justify-center mt-6">
          <p-button label="Iniciar sesión" (click)="onLogin()"></p-button>
        </div>

        <div class="text-center mt-6">
          <a
            routerLink="/"
            class="text-sm font-color cursor-pointer"
            (click)="openDialogForgot = true"
          >
            ¿Has olvidado tu contraseña?
          </a>
        </div>
      </form>
    </div>

    <div class="md:ml-6 divider"></div>
    <div class="divider-mobile sm:hidden"></div>

    <div class="flex-1 p-6 flex flex-col items-center">
      <h2 class="mb-4 h2-form">Registro</h2>
      <form #registerForm="ngForm" class="max-w-[332px]">
        <div class="mb-5">
          <label for="nombre">Nombre</label>
          <p-inputGroup>
            <p-inputGroupAddon>
              <i class="pi pi-user"></i>
            </p-inputGroupAddon>
            <input
              pInputText
              placeholder="Introduce tu nombre..."
              [(ngModel)]="nombre"
              name="nombre"
              required
            />
          </p-inputGroup>
        </div>

        <div class="mb-5">
          <label for="apellidos">Apellidos</label>
          <p-inputGroup>
            <p-inputGroupAddon>
              <i class="pi pi-user"></i>
            </p-inputGroupAddon>
            <input
              pInputText
              placeholder="Introduce tus apellidos..."
              [(ngModel)]="apellidos"
              name="apellidos"
              required
            />
          </p-inputGroup>
        </div>

        <div class="mb-5">
          <label for="email">Email</label>
          <p-inputGroup>
            <p-inputGroupAddon>
              <i class="pi pi-envelope"></i>
            </p-inputGroupAddon>
            <input
              pInputText
              placeholder="Introduce tu email..."
              [(ngModel)]="emailRegister"
              name="email"
              autocomplete="email"
              required
            />
          </p-inputGroup>
        </div>

        <label for="password">Contraseña</label>
        <div class="mb-5 password-style">
          <div class="flex">
            <div class="flex">
              <p-inputGroupAddon>
                <i class="pi pi-lock"></i>
              </p-inputGroupAddon>

              <p-password
                [toggleMask]="true"
                styleClass="w-72"
                placeholder="Introduce tu contraseña..."
                [(ngModel)]="passwordRegister"
                name="password"
                autocomplete="new-password"
                required
              ></p-password>
            </div>
          </div>
        </div>

        <label for="password">Contraseña de nuevo</label>
        <div class="mb-5 password-style">
          <div class="flex">
            <div class="flex">
              <p-inputGroupAddon>
                <i class="pi pi-lock"></i>
              </p-inputGroupAddon>

              <p-password
                [toggleMask]="true"
                styleClass="w-72"
                placeholder="Introduce tu contraseña..."
                [(ngModel)]="passwordRegisterConfirm"
                name="passwordConfirm"
                autocomplete="new-password"
                required
              ></p-password>
            </div>
          </div>
        </div>

        <div *ngFor="let message of messagesRegister">
          <p-message
            [life]="8000"
            icon="pi pi-times-circle"
            [severity]="message.severity"
            [text]="message.text"
            [closable]="true"
            styleClass="custom-messages"
          ></p-message>
        </div>

        <div class="pt-11 -mb-6" *ngIf="loadingRegister">
          <app-loading></app-loading>
        </div>

        <div class="w-full flex justify-center mt-8 pb-12 sm:pb-0">
          <p-button
            label="Registrarse"
            (click)="onRegisterSubmit(registerForm)"
          ></p-button>
        </div>

        <div class="w-full flex justify-center mt-4">
          <button
            class="p-button verify italic"
            (click)="openModalVerifyCode()"
          >
            Verificar cuenta
          </button>
        </div>
      </form>
    </div>
  </div>
</div>

<p-dialog
  header=""
  [(visible)]="openDialogForgot"
  [modal]="true"
  styleClass="w-full sm:w-10/12 md:w-1/4 p-3 min-w-[400px]"
  [closable]="true"
  (onHide)="openDialog = false"
  ><div class="flex flex-col items-center">
    <div class="font-bold text-2xl mb-2">Restablecer contraseña</div>
    <p class="text-sm text-neutral-500 block mb-3 px-4">
      *La contraseña solo puede restablecerse 1 vez cada 3 meses, por favor
      asegurate de tener acceso a tu email.
    </p>
    <p class="text-muted-color block mb-6">Por favor introduce tu email.</p>
    <form #resendFormForgot="ngForm">
      <div class="mb-4 w-80">
        <p-inputGroup>
          <p-inputGroupAddon>
            <i class="pi pi-envelope"></i>
          </p-inputGroupAddon>
          <input
            pInputText
            placeholder="Introduce tu email..."
            [(ngModel)]="emailResentForgot"
            name="email"
            required
          />
        </p-inputGroup>
      </div>
    </form>

    <div *ngFor="let message of messagesResendForgot">
      <p-message
        [life]="8000"
        icon="pi pi-times-circle"
        [severity]="message.severity"
        [text]="message.text"
        [closable]="true"
        styleClass="custom-messages my-1 w-96"
      ></p-message>
    </div>

    <div class="pt-11 -mb-6" *ngIf="loadingResetPassword">
      <app-loading></app-loading>
    </div>

    <div class="flex m-auto gap-10 mt-4 mb-4 self-stretch">
      <p-button
        label="Enviar enlace"
        (click)="resendEmailForgot(resendFormForgot)"
      />
    </div></div
></p-dialog>

<p-dialog
  header=""
  [(visible)]="openDialog"
  [modal]="true"
  styleClass="w-full sm:w-10/12 md:w-1/4 p-3 min-w-[400px]"
  [closable]="true"
  (onHide)="openDialog = false"
  ><div class="flex flex-col items-center">
    <div class="font-bold text-2xl mb-2">Verifica tu cuenta</div>
    <p class="text-muted-color block mb-8">
      Por favor introduce tu email y el código recibido.
    </p>

    <form #resendForm="ngForm">
      <div class="mb-4 w-80">
        <p-inputGroup>
          <p-inputGroupAddon>
            <i class="pi pi-envelope"></i>
          </p-inputGroupAddon>
          <input
            pInputText
            placeholder="Introduce tu email..."
            [(ngModel)]="emailVerify"
            name="email"
            required
          />
        </p-inputGroup>
      </div>
    </form>

    <p-inputotp [(ngModel)]="CodeToVerify" [length]="6">
      <ng-template #input let-token let-events="events" let-index="index">
        <input
          type="text"
          [maxLength]="1"
          (input)="events.input($event)"
          (keydown)="events.keydown($event)"
          [attr.value]="token"
          class="custom-otp-input"
        />
      </ng-template>
    </p-inputotp>
    <div *ngFor="let message of messagesVerify">
      <p-message
        [life]="8000"
        icon="pi pi-times-circle"
        [severity]="message.severity"
        [text]="message.text"
        [closable]="true"
        styleClass="custom-messages mt-4 -mb-4 w-96"
      ></p-message>
    </div>

    <div class="pt-11 -mb-6" *ngIf="loadingVerifyCode">
      <app-loading></app-loading>
    </div>
    <div class="pt-11 -mb-6" *ngIf="loadingReenviarCode">
      <app-loading></app-loading>
    </div>
    <div class="flex m-auto gap-10 mt-8 mb-4 self-stretch">
      <button class="p-button verify" (click)="resendVerificationCode()">
        Reenviar código
      </button>
      <p-button label="Verificar código" (click)="verifyCode(resendForm)" />
    </div></div
></p-dialog>
